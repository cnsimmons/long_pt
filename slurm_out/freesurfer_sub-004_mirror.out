Subject Stamp: freesurfer-linux-centos7_x86_64-7.1.0-20200511-813297b
Current Stamp: freesurfer-linux-centos7_x86_64-7.1.0-20200511-813297b
INFO: SUBJECTS_DIR is /user_data/csimmon2/long_pt/derivatives/freesurfer
Actual FREESURFER_HOME /opt/freesurfer/7.1.0
Linux mind-0-15 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Fri Oct 28 15:56:52 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux
Can't locate MNI/Startup.pm in @INC (you may need to install the MNI::Startup module) (@INC contains: /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5) at /opt/freesurfer/7.1.0/mni/bin/nu_correct line 37.
BEGIN failed--compilation aborted at /opt/freesurfer/7.1.0/mni/bin/nu_correct line 37.
'/opt/freesurfer/7.1.0/bin/recon-all' -> '/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/scripts/recon-all.local-copy'
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror

 mri_convert /user_data/csimmon2/long_pt/sub-004/ses-01/anat/sub-004_ses-01_T1w_brain_mirrored.nii.gz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig/001.mgz 

mri_convert /user_data/csimmon2/long_pt/sub-004/ses-01/anat/sub-004_ses-01_T1w_brain_mirrored.nii.gz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig/001.mgz 
reading from /user_data/csimmon2/long_pt/sub-004/ses-01/anat/sub-004_ses-01_T1w_brain_mirrored.nii.gz...
niiRead(): NIFTI_UNITS_UNKNOWN, assuming mm
niiRead(): detected input as 64 bit double, reading in as 32 bit float
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (1, 0, 0)
j_ras = (0, 1, 0)
k_ras = (0, 0, 1)
writing to /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig/001.mgz...
@#@FSTIME  2025:10:08:13:28:49 mri_convert N 2 e 0.70 S 0.01 U 0.71 P 103% M 51892 F 0 R 994 W 0 c 4 w 102 I 10000 O 7432 L 17.08 14.62 13.77
@#@FSLOADPOST 2025:10:08:13:28:50 mri_convert N 2 17.08 14.62 13.77
#--------------------------------------------
#@# MotionCor Wed Oct  8 13:28:50 EDT 2025
Found 1 runs
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig/001.mgz
Checking for (invalid) multi-frame inputs...
Only one run found so motion
correction will not be performed. I'll
copy the run to rawavg and continue.

 cp /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig/001.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/rawavg.mgz 

/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror

 mri_convert /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/rawavg.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig.mgz --conform 

mri_convert /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/rawavg.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig.mgz --conform 
reading from /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/rawavg.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (1, 0, 0)
j_ras = (0, 1, 0)
k_ras = (0, 0, 1)
changing data type from float to uchar (noscale = 0)...
MRIchangeType: Building histogram 0 634.91 1000, flo=0, fhi=0.999, dest_type=0
Reslicing using trilinear interpolation 
writing to /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig.mgz...
@#@FSTIME  2025:10:08:13:28:53 mri_convert N 3 e 1.39 S 0.00 U 1.45 P 104% M 63452 F 0 R 5985 W 0 c 8 w 48 I 0 O 2712 L 16.75 14.59 13.77
@#@FSLOADPOST 2025:10:08:13:28:55 mri_convert N 3 16.75 14.59 13.77

 mri_add_xform_to_header -c /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/transforms/talairach.xfm /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/orig.mgz 

INFO: extension is mgz
@#@FSTIME  2025:10:08:13:28:55 mri_add_xform_to_header N 4 e 0.22 S 0.01 U 0.36 P 167% M 22676 F 0 R 971 W 0 c 6 w 39 I 0 O 2712 L 16.75 14.59 13.77
@#@FSLOADPOST 2025:10:08:13:28:55 mri_add_xform_to_header N 4 16.75 14.59 13.77
#--------------------------------------------
#@# Talairach Wed Oct  8 13:28:55 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 mri_nu_correct.mni --no-rescale --i orig.mgz --o orig_nu.mgz --ants-n4 --n 1 --proto-iters 1000 --distance 50 

/usr/bin/bc
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri
/opt/freesurfer/7.1.0/bin/mri_nu_correct.mni
--no-rescale --i orig.mgz --o orig_nu.mgz --ants-n4 --n 1 --proto-iters 1000 --distance 50
nIters 1
mri_nu_correct.mni 7.1.0
Linux mind-0-15 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Fri Oct 28 15:56:52 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux
Wed Oct  8 13:28:55 EDT 2025
Found /dev/shm , will use for temp dir
tmpdir is /dev/shm/tmp.mri_nu_correct.mni.2895358
cd /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri
AntsN4BiasFieldCorrectionFs -i orig.mgz -o /dev/shm/tmp.mri_nu_correct.mni.2895358/nu0.mgz
Using shrink factor: 4
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2895358/nu0.mgz orig_nu.mgz --like orig.mgz --conform
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2895358/nu0.mgz orig_nu.mgz --like orig.mgz --conform 
reading from /dev/shm/tmp.mri_nu_correct.mni.2895358/nu0.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 0, 0)
j_ras = (0, 0, -1)
k_ras = (0, 1, 0)
INFO: transform src into the like-volume: orig.mgz
writing to orig_nu.mgz...
 
 
Wed Oct  8 13:31:23 EDT 2025
mri_nu_correct.mni done
@#@FSTIME  2025:10:08:13:28:55 mri_nu_correct.mni N 12 e 148.10 S 0.10 U 147.84 P 99% M 486592 F 6 R 79629 W 0 c 68 w 230 I 4024 O 2856 L 16.75 14.59 13.77
@#@FSLOADPOST 2025:10:08:13:31:23 mri_nu_correct.mni N 12 15.33 15.02 14.07

 talairach_avi --i orig_nu.mgz --xfm transforms/talairach.auto.xfm --atlas 3T18yoSchwartzReactN32_as_orig 

talairach_avi log file is transforms/talairach_avi.log...
Started at Wed Oct 8 13:31:23 EDT 2025
Ended   at Wed Oct  8 13:31:38 EDT 2025
talairach_avi done
@#@FSTIME  2025:10:08:13:31:23 talairach_avi N 6 e 15.14 S 0.43 U 8.25 P 57% M 255440 F 0 R 28512 W 0 c 54 w 5472 I 77864 O 295976 L 15.33 15.02 14.07
@#@FSLOADPOST 2025:10:08:13:31:38 talairach_avi N 6 15.19 15.00 14.08

 cp transforms/talairach.auto.xfm transforms/talairach.xfm 

lta_convert --src orig.mgz --trg /opt/freesurfer/7.1.0/average/mni305.cor.mgz --inxfm transforms/talairach.xfm --outlta transforms/talairach.xfm.lta --subject fsaverage --ltavox2vox
7.1.0

--src: orig.mgz src image (geometry).
--trg: /opt/freesurfer/7.1.0/average/mni305.cor.mgz trg image (geometry).
--inmni: transforms/talairach.xfm input MNI/XFM transform.
--outlta: transforms/talairach.xfm.lta output LTA.
--s: fsaverage subject name
--ltavox2vox: output LTA as VOX_TO_VOX transform.
 LTA read, type : 1
 1.06277  -0.04214  -0.00926  -4.29874;
 0.04363   1.05152   0.01852  -5.25101;
 0.01161  -0.10685   1.23483  -26.93867;
 0.00000   0.00000   0.00000   1.00000;
setting subject to fsaverage
Writing  LTA to file transforms/talairach.xfm.lta...
lta_convert successful.
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/transforms /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri 
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri 
#--------------------------------------------
#@# Talairach Failure Detection Wed Oct  8 13:31:41 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 talairach_afd -T 0.005 -xfm transforms/talairach.xfm 

talairach_afd: Talairach Transform: transforms/talairach.xfm OK (p=0.7601, pval=0.6675 >= threshold=0.0050)
@#@FSTIME  2025:10:08:13:31:41 talairach_afd N 4 e 0.00 S 0.00 U 0.00 P 100% M 5132 F 0 R 198 W 0 c 1 w 3 I 0 O 0 L 15.19 15.00 14.08
@#@FSLOADPOST 2025:10:08:13:31:41 talairach_afd N 4 15.19 15.00 14.08

 awk -f /opt/freesurfer/7.1.0/bin/extract_talairach_avi_QA.awk /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/transforms/talairach_avi.log 


 tal_QC_AZS /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/transforms/talairach_avi.log 

TalAviQA: 0.95823
z-score: -4
#--------------------------------------------
#@# Nu Intensity Correction Wed Oct  8 13:31:41 EDT 2025

 mri_nu_correct.mni --i orig.mgz --o nu.mgz --uchar transforms/talairach.xfm --proto-iters 1000 --distance 50 --n 1 --ants-n4 

/usr/bin/bc
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri
/opt/freesurfer/7.1.0/bin/mri_nu_correct.mni
--i orig.mgz --o nu.mgz --uchar transforms/talairach.xfm --proto-iters 1000 --distance 50 --n 1 --ants-n4
nIters 1
mri_nu_correct.mni 7.1.0
Linux mind-0-15 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Fri Oct 28 15:56:52 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux
Wed Oct  8 13:31:41 EDT 2025
Found /dev/shm , will use for temp dir
tmpdir is /dev/shm/tmp.mri_nu_correct.mni.2897556
cd /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri
AntsN4BiasFieldCorrectionFs -i orig.mgz -o /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz
Using shrink factor: 4
mri_binarize --i /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz --min -1 --o /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz

7.1.0
cwd /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri
cmdline mri_binarize --i /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz --min -1 --o /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz 
sysname  Linux
hostname mind-0-15
machine  x86_64
user     csimmon2

input      /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz
frame      0
nErode3d   0
nErode2d   0
output     /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz
Binarizing based on threshold
min        -1
max        +infinity
binval        1
binvalnot     0
fstart = 0, fend = 0, nframes = 1
Found 16777216 values in range
Counting number of voxels in first frame
Found 16777215 voxels in final mask
Count: 16777215 16777215.000000 16777216 99.999994
mri_binarize done
mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz --i orig.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897556/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897556/input.mean.dat

7.1.0
cwd 
cmdline mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz --i orig.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897556/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897556/input.mean.dat 
sysname  Linux
hostname mind-0-15
machine  x86_64
user     csimmon2
whitesurfname  white
UseRobust  0
Loading /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz
Loading orig.mgz
Voxel Volume is 1 mm^3
Generating list of segmentation ids
Found   1 segmentations
Computing statistics for each segmentation

Reporting on   1 segmentations
Using PrintSegStat
Computing spatial average of each frame
  0
Writing to /dev/shm/tmp.mri_nu_correct.mni.2897556/input.mean.dat
mri_segstats done
mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz --i /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897556/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897556/output.mean.dat

7.1.0
cwd 
cmdline mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz --i /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897556/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897556/output.mean.dat 
sysname  Linux
hostname mind-0-15
machine  x86_64
user     csimmon2
whitesurfname  white
UseRobust  0
Loading /dev/shm/tmp.mri_nu_correct.mni.2897556/ones.mgz
Loading /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz
Voxel Volume is 1 mm^3
Generating list of segmentation ids
Found   1 segmentations
Computing statistics for each segmentation

Reporting on   1 segmentations
Using PrintSegStat
Computing spatial average of each frame
  0
Writing to /dev/shm/tmp.mri_nu_correct.mni.2897556/output.mean.dat
mri_segstats done
mris_calc -o /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz mul 1.01990499762257888787
Saving result to '/dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz' (type = MGH )                       [ ok ]
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz nu.mgz --like orig.mgz
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz nu.mgz --like orig.mgz 
reading from /dev/shm/tmp.mri_nu_correct.mni.2897556/nu0.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 0, 0)
j_ras = (0, 0, -1)
k_ras = (0, 1, 0)
INFO: transform src into the like-volume: orig.mgz
writing to nu.mgz...
mri_make_uchar nu.mgz transforms/talairach.xfm nu.mgz
type change took 0 minutes and 3 seconds.
mapping (52, 219) to ( 3, 110)
 
 
Wed Oct  8 13:34:18 EDT 2025
mri_nu_correct.mni done
@#@FSTIME  2025:10:08:13:31:41 mri_nu_correct.mni N 13 e 157.88 S 0.33 U 158.66 P 100% M 613688 F 25 R 221822 W 0 c 124 w 487 I 6144 O 7384 L 15.19 15.00 14.08
@#@FSLOADPOST 2025:10:08:13:34:18 mri_nu_correct.mni N 13 17.39 16.18 14.69

 mri_add_xform_to_header -c /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri/transforms/talairach.xfm nu.mgz nu.mgz 

INFO: extension is mgz
@#@FSTIME  2025:10:08:13:34:18 mri_add_xform_to_header N 4 e 0.28 S 0.01 U 0.46 P 168% M 22800 F 1 R 971 W 0 c 10 w 43 I 2704 O 2448 L 17.39 16.18 14.69
@#@FSLOADPOST 2025:10:08:13:34:19 mri_add_xform_to_header N 4 17.39 16.18 14.69
#--------------------------------------------
#@# Intensity Normalization Wed Oct  8 13:34:19 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 mri_normalize -g 1 -seed 1234 -mprage nu.mgz T1.mgz 

using max gradient = 1.000
setting seed for random number genererator to 1234
assuming input volume is MGH (Van der Kouwe) MP-RAGE
reading mri_src from nu.mgz...
normalizing image...
talairach transform
 1.06277  -0.04214  -0.00926  -4.29874;
 0.04363   1.05152   0.01852  -5.25101;
 0.01161  -0.10685   1.23483  -26.93867;
 0.00000   0.00000   0.00000   1.00000;
processing without aseg, no1d=0
MRInormInit(): 
INFO: Modifying talairach volume c_(r,a,s) based on average_305
MRInormalize(): 
MRIsplineNormalize(): npeaks = 15
Starting OpenSpline(): npoints = 15
building Voronoi diagram...
performing soap bubble smoothing, sigma = 8...

Iterating 2 times
---------------------------------
3d normalization pass 1 of 2
white matter peak found at 110
white matter peak found at 108
gm peak at 57 (57), valley at  0 (-1)
csf peak at 28, setting threshold to 47
building Voronoi diagram...
performing soap bubble smoothing, sigma = 8...
---------------------------------
3d normalization pass 2 of 2
white matter peak found at 110
white matter peak found at 110
gm peak at 56 (56), valley at  0 (-1)
csf peak at 28, setting threshold to 46
building Voronoi diagram...
performing soap bubble smoothing, sigma = 8...
Done iterating ---------------------------------
writing output to T1.mgz
3D bias adjustment took 1 minutes and 2 seconds.
@#@FSTIME  2025:10:08:13:34:19 mri_normalize N 7 e 62.29 S 0.12 U 77.61 P 124% M 583428 F 0 R 27029 W 0 c 59 w 63 I 2448 O 2320 L 17.39 16.18 14.69
@#@FSLOADPOST 2025:10:08:13:35:21 mri_normalize N 7 17.65 16.55 14.93
#--------------------------------------------
#@# Skull Stripping Wed Oct  8 13:35:21 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 mri_em_register -skull nu.mgz /opt/freesurfer/7.1.0/average/RB_all_withskull_2020_01_02.gca transforms/talairach_with_skull.lta 

aligning to atlas containing skull, setting unknown_nbr_spacing = 5

== Number of threads available to mri_em_register for OpenMP = 4 == 
reading 1 input volumes...
logging results to talairach_with_skull.log
reading '/opt/freesurfer/7.1.0/average/RB_all_withskull_2020_01_02.gca'...
GCAread took 0 minutes and 1 seconds.
average std = 23.0   using min determinant for regularization = 52.8
0 singular and 9205 ill-conditioned covariance matrices regularized
reading 'nu.mgz'...
freeing gibbs priors...done.
accounting for voxel sizes in initial transform
bounding unknown intensity as < 8.9 or > 556.0 
total sample mean = 77.3 (1403 zeros)
************************************************
spacing=8, using 3292 sample points, tol=1.00e-05...
************************************************
register_mri: find_optimal_transform
find_optimal_transform: nsamples 3292, passno 0, spacing 8
resetting wm mean[0]: 100 --> 108
resetting gm mean[0]: 61 --> 61
input volume #1 is the most T1-like
using real data threshold=26.9
skull bounding box = (64, 45, 34) --> (193, 152, 197)
finding center of left hemi white matter
using (107, 81, 116) as brain centroid of Right_Cerebral_White_Matter...
MRImask(): AllowDiffGeom = 1
mean wm in atlas = 108, using box (91,68,96) --> (122, 94,136) to find MRI wm
before smoothing, mri peak at 108
robust fit to distribution - 107 +- 6.5
after smoothing, mri peak at 107, scaling input intensities by 1.009
scaling channel 0 by 1.00935
initial log_p = -4.753
************************************************
First Search limited to translation only.
************************************************
max log p =    -4.647764 @ (-10.526, 10.526, -10.526)
max log p =    -4.393282 @ (5.263, 5.263, 5.263)
max log p =    -4.384736 @ (2.632, -2.632, -2.632)
max log p =    -4.384736 @ (0.000, 0.000, 0.000)
max log p =    -4.364911 @ (0.658, 4.605, 4.605)
max log p =    -4.364911 @ (0.000, 0.000, 0.000)
max log p =    -4.364911 @ (0.000, 0.000, 0.000)
max log p =    -4.364911 @ (0.000, 0.000, 0.000)
Found translation: (-2.0, 17.8, -3.3): log p = -4.365
****************************************
Nine parameter search.  iteration 0 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.054, old_max_log_p =-4.365 (thresh=-4.4)
 1.15000   0.00000   0.00000  -21.03511;
 0.00000   1.14016   0.15011  -16.84608;
 0.00000  -0.16136   1.22567  -9.05440;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 21 seconds.
****************************************
Nine parameter search.  iteration 1 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.029, old_max_log_p =-4.054 (thresh=-4.0)
 1.15000   0.00000   0.00000  -21.03511;
 0.00000   1.23783  -0.01200  -10.43691;
 0.00000  -0.01200   1.32739  -39.26944;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 21 seconds.
****************************************
Nine parameter search.  iteration 2 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.002, old_max_log_p =-4.029 (thresh=-4.0)
 1.06375   0.00000   0.00000  -10.07479;
 0.00000   1.31760   0.17347  -34.08366;
 0.00000  -0.16046   1.21878  -8.37817;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 21 seconds.
****************************************
Nine parameter search.  iteration 3 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.002, old_max_log_p =-4.002 (thresh=-4.0)
 1.06375   0.00000   0.00000  -10.07479;
 0.00000   1.31760   0.17347  -34.08366;
 0.00000  -0.16046   1.21878  -8.37817;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.2500
iteration took 0 minutes and 21 seconds.
****************************************
Nine parameter search.  iteration 4 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-3.948, old_max_log_p =-4.002 (thresh=-4.0)
 1.10364   0.00000   0.00000  -17.01894;
 0.00000   1.29289   0.17021  -32.65503;
 0.00000  -0.16959   1.28819  -15.18666;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 21 seconds.
****************************************
Nine parameter search.  iteration 5 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-3.948, old_max_log_p =-3.948 (thresh=-3.9)
 1.10364   0.00000   0.00000  -17.01894;
 0.00000   1.29289   0.17021  -32.65503;
 0.00000  -0.16959   1.28819  -15.18666;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.0625
iteration took 0 minutes and 21 seconds.
****************************************
Nine parameter search.  iteration 6 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.932, old_max_log_p =-3.948 (thresh=-3.9)
 1.09969   0.00921   0.01190  -18.49646;
-0.00900   1.29437   0.17032  -31.69421;
-0.00900  -0.16899   1.28362  -14.50867;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 20 seconds.
****************************************
Nine parameter search.  iteration 7 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.925, old_max_log_p =-3.932 (thresh=-3.9)
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 20 seconds.
****************************************
Nine parameter search.  iteration 8 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.925, old_max_log_p =-3.925 (thresh=-3.9)
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;
min search scale 0.025000 reached
***********************************************
Computing MAP estimate using 3292 samples...
***********************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-05
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;
nsamples 3292
Quasinewton: input matrix
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 3 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 011: -log(p) =   -0.0  tol 0.000010
Resulting transform:
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;

pass 1, spacing 8: log(p) = -3.925 (old=-4.753)
transform before final EM align:
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;

**************************************************
 EM alignment process ...
 Computing final MAP estimate using 364986 samples. 
**************************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-07
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;
nsamples 364986
Quasinewton: input matrix
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 6 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 013: -log(p) =    4.4  tol 0.000000
final transform:
 1.09711   0.00919   0.01187  -18.15989;
-0.00899   1.29285   0.17012  -31.49005;
-0.00899  -0.16879   1.28212  -14.36139;
 0.00000   0.00000   0.00000   1.00000;

writing output transformation to transforms/talairach_with_skull.lta...
#VMPC# mri_em_register VmPeak  824488
FSRUNTIME@ mri_em_register  0.0617 hours 4 threads
registration took 3 minutes and 42 seconds.
@#@FSTIME  2025:10:08:13:35:21 mri_em_register N 4 e 222.23 S 1.31 U 797.17 P 359% M 628564 F 6 R 1022786 W 0 c 685 w 249 I 150888 O 32 L 17.65 16.55 14.93
@#@FSLOADPOST 2025:10:08:13:39:03 mri_em_register N 4 18.76 18.73 16.23

 mri_watershed -T1 -brain_atlas /opt/freesurfer/7.1.0/average/RB_all_withskull_2020_01_02.gca transforms/talairach_with_skull.lta T1.mgz brainmask.auto.mgz 


Mode:          T1 normalized volume
Mode:          Use the information of atlas (default parms, --help for details)

*********************************************************
The input file is T1.mgz
The output file is brainmask.auto.mgz
Weighting the input with atlas information before watershed

*************************WATERSHED**************************
Sorting...
      first estimation of the COG coord: x=130 y=94 z=110 r=56
      first estimation of the main basin volume: 764453 voxels
      Looking for seedpoints 
        2 found in the cerebellum 
        11 found in the rest of the brain 
      global maximum in x=108, y=88, z=83, Imax=255
      CSF=12, WM_intensity=110, WM_VARIANCE=5
      WM_MIN=110, WM_HALF_MIN=110, WM_HALF_MAX=110, WM_MAX=110 
      preflooding height equal to 10 percent
done.
Analyze...

      main basin size=6392880079 voxels, voxel volume =1.000 
                     = 6392880079 mmm3 = 6392880.128 cm3
done.
PostAnalyze...Basin Prior
 134 basins merged thanks to atlas 
      ***** 0 basin(s) merged in 1 iteration(s)
      ***** 0 voxel(s) added to the main basin
done.
Weighting the input with prior template 

****************TEMPLATE DEFORMATION****************

      second estimation of the COG coord: x=128,y=102, z=108, r=8863 iterations
^^^^^^^^ couldn't find WM with original limits - expanding ^^^^^^

   GLOBAL      CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 45414
  RIGHT_CER    CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 2988
  LEFT_CER     CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 2556
 RIGHT_BRAIN   CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 19764
 LEFT_BRAIN    CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 19512
    OTHER      CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 594
   
                     CSF_MAX  TRANSITION  GM_MIN  GM
    GLOBAL     
  before analyzing :    3,      4,        31,   48
  after  analyzing :    3,      22,        31,   28
   RIGHT_CER   
  before analyzing :    3,      4,        33,   55
  after  analyzing :    3,      23,        33,   31
   LEFT_CER    
  before analyzing :    3,      4,        32,   50
  after  analyzing :    3,      22,        32,   29
  RIGHT_BRAIN  
  before analyzing :    3,      4,        31,   48
  after  analyzing :    3,      22,        31,   28
  LEFT_BRAIN   
  before analyzing :    3,      4,        31,   48
  after  analyzing :    3,      22,        31,   28
     OTHER     
  before analyzing :    3,      4,        31,   48
  after  analyzing :    3,      22,        31,   28
      mri_strip_skull: done peeling brain
      highly tesselated surface with 10242 vertices
      matching...77 iterations

*********************VALIDATION*********************
curvature mean = -0.013, std = 0.013
curvature mean = 68.502, std = 8.733

No Rigid alignment: -atlas Mode Off (basic atlas / no registration)
      before rotation: sse = 3.98, sigma = 5.99
      after  rotation: sse = 3.98, sigma = 5.99
Localization of inacurate regions: Erosion-Dilation steps
      the sse mean is  4.64, its var is  7.86   
      before Erosion-Dilatation  1.88% of inacurate vertices
      after  Erosion-Dilatation  0.00% of inacurate vertices
      Validation of the shape of the surface done.
Scaling of atlas fields onto current surface fields

********FINAL ITERATIVE TEMPLATE DEFORMATION********
Compute Local values csf/gray
Fine Segmentation...29 iterations

      mri_strip_skull: done peeling brain

Brain Size = 1528089 voxels, voxel volume = 1.000 mm3
           = 1528089 mmm3 = 1528.089 cm3
MRImask(): AllowDiffGeom = 1


******************************
Saving brainmask.auto.mgz
done
mri_watershed utimesec    12.145120
mri_watershed stimesec    0.194234
mri_watershed ru_maxrss   802284
mri_watershed ru_ixrss    0
mri_watershed ru_idrss    0
mri_watershed ru_isrss    0
mri_watershed ru_minflt   282272
mri_watershed ru_majflt   0
mri_watershed ru_nswap    0
mri_watershed ru_inblock  2320
mri_watershed ru_oublock  2304
mri_watershed ru_msgsnd   0
mri_watershed ru_msgrcv   0
mri_watershed ru_nsignals 0
mri_watershed ru_nvcsw    686
mri_watershed ru_nivcsw   31
mri_watershed done
@#@FSTIME  2025:10:08:13:39:03 mri_watershed N 6 e 8.44 S 0.21 U 12.14 P 146% M 802284 F 0 R 282287 W 0 c 32 w 687 I 2320 O 2304 L 18.76 18.73 16.23
@#@FSLOADPOST 2025:10:08:13:39:12 mri_watershed N 6 17.94 18.56 16.20

 cp brainmask.auto.mgz brainmask.mgz 

#-------------------------------------
#@# EM Registration Wed Oct  8 13:39:13 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 mri_em_register -uns 3 -mask brainmask.mgz nu.mgz /opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca transforms/talairach.lta 

setting unknown_nbr_spacing = 3
using MR volume brainmask.mgz to mask input volume...

== Number of threads available to mri_em_register for OpenMP = 4 == 
reading 1 input volumes...
logging results to talairach.log
reading '/opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca'...
GCAread took 0 minutes and 0 seconds.
average std = 7.2   using min determinant for regularization = 5.2
0 singular and 884 ill-conditioned covariance matrices regularized
reading 'nu.mgz'...
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
freeing gibbs priors...done.
accounting for voxel sizes in initial transform
bounding unknown intensity as < 5.9 or > 519.0 
total sample mean = 79.1 (1017 zeros)
************************************************
spacing=8, using 2841 sample points, tol=1.00e-05...
************************************************
register_mri: find_optimal_transform
find_optimal_transform: nsamples 2841, passno 0, spacing 8
resetting wm mean[0]: 98 --> 107
resetting gm mean[0]: 61 --> 61
input volume #1 is the most T1-like
using real data threshold=26.9
skull bounding box = (64, 45, 34) --> (193, 152, 190)
finding center of left hemi white matter
using (107, 81, 112) as brain centroid of Right_Cerebral_White_Matter...
MRImask(): AllowDiffGeom = 1
mean wm in atlas = 107, using box (91,68,93) --> (122, 94,131) to find MRI wm
before smoothing, mri peak at 108
robust fit to distribution - 107 +- 6.4
after smoothing, mri peak at 107, scaling input intensities by 1.000
scaling channel 0 by 1
initial log_p = -4.291
************************************************
First Search limited to translation only.
************************************************
max log p =    -4.038843 @ (-10.526, 10.526, -10.526)
max log p =    -3.781947 @ (5.263, 5.263, 5.263)
max log p =    -3.780656 @ (2.632, 2.632, 2.632)
max log p =    -3.780656 @ (0.000, 0.000, 0.000)
max log p =    -3.749664 @ (-3.289, 0.658, -0.658)
max log p =    -3.739807 @ (3.618, -0.987, -0.987)
max log p =    -3.739807 @ (0.000, 0.000, 0.000)
max log p =    -3.739807 @ (0.000, 0.000, 0.000)
Found translation: (-2.3, 18.1, -4.3): log p = -3.740
****************************************
Nine parameter search.  iteration 0 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-3.639, old_max_log_p =-3.740 (thresh=-3.7)
 1.00000   0.00000   0.00000  -2.30263;
 0.00000   1.15000   0.00000   2.91238;
 0.00000   0.00000   1.00000  -4.27632;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 19 seconds.
****************************************
Nine parameter search.  iteration 1 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-3.639, old_max_log_p =-3.639 (thresh=-3.6)
 1.00000   0.00000   0.00000  -2.30263;
 0.00000   1.15000   0.00000   2.91238;
 0.00000   0.00000   1.00000  -4.27632;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.2500
iteration took 0 minutes and 19 seconds.
****************************************
Nine parameter search.  iteration 2 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-3.496, old_max_log_p =-3.639 (thresh=-3.6)
 1.03465  -0.03234  -0.07088   2.51943;
 0.03669   1.16547   0.09747  -17.89868;
 0.06659  -0.11467   1.01167  -2.42464;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 18 seconds.
****************************************
Nine parameter search.  iteration 3 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-3.495, old_max_log_p =-3.496 (thresh=-3.5)
 1.05571  -0.03676  -0.03845  -1.46285;
 0.03669   1.16547   0.09747  -17.89868;
 0.03332  -0.11568   1.03245  -0.24526;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.0625
iteration took 0 minutes and 18 seconds.
****************************************
Nine parameter search.  iteration 4 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.480, old_max_log_p =-3.495 (thresh=-3.5)
 1.05721  -0.02755  -0.03762  -3.19336;
 0.02896   1.16641   0.11484  -18.44578;
 0.03255  -0.13434   1.02709   1.47132;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 18 seconds.
****************************************
Nine parameter search.  iteration 5 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.467, old_max_log_p =-3.480 (thresh=-3.5)
 1.05593  -0.03815  -0.03014  -2.28549;
 0.03765   1.16751   0.11473  -19.67425;
 0.02385  -0.13396   1.02616   2.66166;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 18 seconds.
****************************************
Nine parameter search.  iteration 6 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.456, old_max_log_p =-3.467 (thresh=-3.5)
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 18 seconds.
****************************************
Nine parameter search.  iteration 7 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.456, old_max_log_p =-3.456 (thresh=-3.5)
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
min search scale 0.025000 reached
***********************************************
Computing MAP estimate using 2841 samples...
***********************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-05
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
nsamples 2841
Quasinewton: input matrix
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 3 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 010: -log(p) =   -0.0  tol 0.000010
Resulting transform:
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;

pass 1, spacing 8: log(p) = -3.456 (old=-4.291)
transform before final EM align:
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;

**************************************************
 EM alignment process ...
 Computing final MAP estimate using 315638 samples. 
**************************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-07
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
nsamples 315638
Quasinewton: input matrix
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 6 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 012: -log(p) =    3.9  tol 0.000000
final transform:
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;

writing output transformation to transforms/talairach.lta...
#VMPC# mri_em_register VmPeak  811948
FSRUNTIME@ mri_em_register  0.0477 hours 4 threads
registration took 2 minutes and 52 seconds.
@#@FSTIME  2025:10:08:13:39:13 mri_em_register N 7 e 171.61 S 1.37 U 622.80 P 363% M 616024 F 0 R 995969 W 0 c 568 w 181 I 0 O 24 L 17.94 18.56 16.20
@#@FSLOADPOST 2025:10:08:13:42:04 mri_em_register N 7 17.20 17.71 16.27
#--------------------------------------
#@# CA Normalize Wed Oct  8 13:42:04 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 mri_ca_normalize -c ctrl_pts.mgz -mask brainmask.mgz nu.mgz /opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca transforms/talairach.lta norm.mgz 

writing control point volume to ctrl_pts.mgz
using MR volume brainmask.mgz to mask input volume...
reading 1 input volume
reading atlas from '/opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca'...
reading transform from 'transforms/talairach.lta'...
reading input volume from nu.mgz...
MRImask(): AllowDiffGeom = 1
resetting wm mean[0]: 98 --> 107
resetting gm mean[0]: 61 --> 61
input volume #1 is the most T1-like
using real data threshold=26.9
skull bounding box = (64, 45, 34) --> (193, 152, 190)
finding center of left hemi white matter
using (107, 81, 112) as brain centroid of Right_Cerebral_White_Matter...
MRImask(): AllowDiffGeom = 1
mean wm in atlas = 107, using box (91,68,93) --> (122, 94,131) to find MRI wm
before smoothing, mri peak at 108
robust fit to distribution - 107 +- 6.4
after smoothing, mri peak at 107, scaling input intensities by 1.000
scaling channel 0 by 1
using 246437 sample points...
INFO: compute sample coordinates transform
 1.05345  -0.03806  -0.03007  -1.98294;
 0.03769   1.16888   0.11487  -19.83709;
 0.02383  -0.13380   1.02495   2.78237;
 0.00000   0.00000   0.00000   1.00000;
INFO: transform used
finding control points in Left_Cerebral_White_Matter....
found 40230 control points for structure...
bounding box (127, 46, 35) --> (192, 144, 197)
Left_Cerebral_White_Matter: limiting intensities to 99.0 --> 132.0
0 of 23 (0.0%) samples deleted
finding control points in Right_Cerebral_White_Matter....
found 39478 control points for structure...
bounding box (67, 48, 35) --> (131, 148, 198)
Right_Cerebral_White_Matter: limiting intensities to 109.0 --> 132.0
14 of 23 (60.9%) samples deleted
finding control points in Left_Cerebellum_White_Matter....
found 3105 control points for structure...
bounding box (130, 119, 59) --> (177, 158, 112)
Left_Cerebellum_White_Matter: limiting intensities to 95.0 --> 132.0
0 of 8 (0.0%) samples deleted
finding control points in Right_Cerebellum_White_Matter....
found 2710 control points for structure...
bounding box (88, 119, 58) --> (129, 159, 114)
Right_Cerebellum_White_Matter: limiting intensities to 90.0 --> 132.0
0 of 20 (0.0%) samples deleted
finding control points in Brain_Stem....
found 3475 control points for structure...
bounding box (114, 113, 95) --> (147, 172, 124)
Brain_Stem: limiting intensities to 88.0 --> 132.0
0 of 10 (0.0%) samples deleted
using 84 total control points for intensity normalization...
bias field = 0.879 +- 0.070
0 of 70 control points discarded
finding control points in Left_Cerebral_White_Matter....
found 40230 control points for structure...
bounding box (127, 46, 35) --> (192, 144, 197)
Left_Cerebral_White_Matter: limiting intensities to 89.0 --> 128.0
0 of 122 (0.0%) samples deleted
finding control points in Right_Cerebral_White_Matter....
found 39478 control points for structure...
bounding box (67, 48, 35) --> (131, 148, 198)
Right_Cerebral_White_Matter: limiting intensities to 88.0 --> 128.0
0 of 92 (0.0%) samples deleted
finding control points in Left_Cerebellum_White_Matter....
found 3105 control points for structure...
bounding box (130, 119, 59) --> (177, 158, 112)
Left_Cerebellum_White_Matter: limiting intensities to 88.0 --> 128.0
5 of 17 (29.4%) samples deleted
finding control points in Right_Cerebellum_White_Matter....
found 2710 control points for structure...
bounding box (88, 119, 58) --> (129, 159, 114)
Right_Cerebellum_White_Matter: limiting intensities to 88.0 --> 128.0
39 of 58 (67.2%) samples deleted
finding control points in Brain_Stem....
found 3475 control points for structure...
bounding box (114, 113, 95) --> (147, 172, 124)
Brain_Stem: limiting intensities to 88.0 --> 128.0
43 of 59 (72.9%) samples deleted
using 348 total control points for intensity normalization...
bias field = 1.020 +- 0.078
0 of 260 control points discarded
finding control points in Left_Cerebral_White_Matter....
found 40230 control points for structure...
bounding box (127, 46, 35) --> (192, 144, 197)
Left_Cerebral_White_Matter: limiting intensities to 90.0 --> 132.0
0 of 276 (0.0%) samples deleted
finding control points in Right_Cerebral_White_Matter....
found 39478 control points for structure...
bounding box (67, 48, 35) --> (131, 148, 198)
Right_Cerebral_White_Matter: limiting intensities to 89.0 --> 119.0
1 of 200 (0.5%) samples deleted
finding control points in Left_Cerebellum_White_Matter....
found 3105 control points for structure...
bounding box (130, 119, 59) --> (177, 158, 112)
Left_Cerebellum_White_Matter: limiting intensities to 88.0 --> 132.0
20 of 48 (41.7%) samples deleted
finding control points in Right_Cerebellum_White_Matter....
found 2710 control points for structure...
bounding box (88, 119, 58) --> (129, 159, 114)
Right_Cerebellum_White_Matter: limiting intensities to 88.0 --> 132.0
31 of 61 (50.8%) samples deleted
finding control points in Brain_Stem....
found 3475 control points for structure...
bounding box (114, 113, 95) --> (147, 172, 124)
Brain_Stem: limiting intensities to 88.0 --> 132.0
55 of 82 (67.1%) samples deleted
using 667 total control points for intensity normalization...
bias field = 0.993 +- 0.064
3 of 555 control points discarded
writing normalized volume to norm.mgz...
writing control points to ctrl_pts.mgz
freeing GCA...done.
normalization took 1 minutes and 3 seconds.
@#@FSTIME  2025:10:08:13:42:04 mri_ca_normalize N 8 e 63.48 S 0.26 U 65.14 P 103% M 871252 F 0 R 351482 W 0 c 84 w 329 I 0 O 3232 L 17.20 17.71 16.27
@#@FSLOADPOST 2025:10:08:13:43:08 mri_ca_normalize N 8 15.51 17.10 16.15
#--------------------------------------
#@# CA Reg Wed Oct  8 13:43:08 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-004_ses01_mirror/mri

 mri_ca_register -nobigventricles -T transforms/talairach.lta -align-after -mask brainmask.mgz norm.mgz /opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca transforms/talairach.m3z 

not handling expanded ventricles...
using previously computed transform transforms/talairach.lta
renormalizing sequences with structure alignment, equivalent to:
	-renormalize
	-regularize_mean 0.500
	-regularize 0.500
using MR volume brainmask.mgz to mask input volume...

== Number of threads available to mri_ca_register for OpenMP = 4 == 
reading 1 input volumes...
logging results to talairach.log
reading input volume 'norm.mgz'...
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
reading GCA '/opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca'...
label assignment complete, 0 changed (0.00%)
freeing gibbs priors...done.
average std[0] = 5.0
Starting GCAMregister()
label assignment complete, 0 changed (0.00%)
npasses = 1, nlevels = 6
#pass# 1 of 1 ************************
enabling zero nodes
setting smoothness cost coefficient to 0.156

#GCAMreg# pass 0 level1 5 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.16 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=256, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.951129
#FOTS# QuadFit found better minimum quadopt=(dt=331.197,rms=0.838544) vs oldopt=(dt=369.92,rms=0.841124)
#GCMRL#    0 dt 331.197238 rms  0.839 11.837% neg 0  invalid 762 tFOTS 3.8890 tGradient 5.3430 tsec 9.5400
#FOTS# QuadFit found better minimum quadopt=(dt=224.431,rms=0.816129) vs oldopt=(dt=369.92,rms=0.823445)
#GCMRL#    1 dt 224.431437 rms  0.816  2.673% neg 0  invalid 762 tFOTS 4.1140 tGradient 5.5320 tsec 9.9600
#FOTS# QuadFit found better minimum quadopt=(dt=252.53,rms=0.799914) vs oldopt=(dt=369.92,rms=0.80246)
#GCMRL#    2 dt 252.529883 rms  0.800  1.987% neg 0  invalid 762 tFOTS 4.0410 tGradient 5.3810 tsec 9.7330
#FOTS# QuadFit found better minimum quadopt=(dt=182.109,rms=0.791849) vs oldopt=(dt=92.48,rms=0.794356)
#GCMRL#    3 dt 182.109091 rms  0.792  1.008% neg 0  invalid 762 tFOTS 4.0670 tGradient 5.4470 tsec 9.8400
#GCMRL#    4 dt 369.920000 rms  0.784  1.013% neg 0  invalid 762 tFOTS 3.8200 tGradient 5.2820 tsec 9.4140
#FOTS# QuadFit found better minimum quadopt=(dt=137.282,rms=0.778391) vs oldopt=(dt=92.48,rms=0.779204)
#GCMRL#    5 dt 137.282443 rms  0.778  0.694% neg 0  invalid 762 tFOTS 4.1930 tGradient 5.3230 tsec 9.8250
#FOTS# QuadFit found better minimum quadopt=(dt=887.808,rms=0.768462) vs oldopt=(dt=1479.68,rms=0.77027)
#GCMRL#    6 dt 887.808000 rms  0.768  1.276% neg 0  invalid 762 tFOTS 4.1410 tGradient 5.2920 tsec 9.7420
#FOTS# QuadFit found better minimum quadopt=(dt=110.976,rms=0.764596) vs oldopt=(dt=92.48,rms=0.764692)
#GCMRL#    7 dt 110.976000 rms  0.765  0.503% neg 0  invalid 762 tFOTS 4.1690 tGradient 5.5410 tsec 10.0210
#FOTS# QuadFit found better minimum quadopt=(dt=2071.55,rms=0.754521) vs oldopt=(dt=1479.68,rms=0.756268)
#GCMRL#    8 dt 2071.552000 rms  0.755  1.318% neg 0  invalid 762 tFOTS 4.1680 tGradient 5.3310 tsec 9.8080
#FOTS# QuadFit found better minimum quadopt=(dt=129.472,rms=0.752381) vs oldopt=(dt=92.48,rms=0.752603)
#GCMRL#    9 dt 129.472000 rms  0.752  0.284% neg 0  invalid 762 tFOTS 4.2730 tGradient 5.4600 tsec 10.0580
#FOTS# QuadFit found better minimum quadopt=(dt=129.472,rms=0.752055) vs oldopt=(dt=92.48,rms=0.752122)
#GCMRL#   10 dt 129.472000 rms  0.752  0.000% neg 0  invalid 762 tFOTS 4.1020 tGradient 5.3210 tsec 9.7450
#GCMRL#   11 dt 129.472000 rms  0.752  0.062% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.0300 tsec 5.3400
#GCMRL#   12 dt 129.472000 rms  0.751  0.094% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4020 tsec 5.7180
#GCMRL#   13 dt 129.472000 rms  0.750  0.118% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4880 tsec 5.7980
#GCMRL#   14 dt 129.472000 rms  0.749  0.132% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5530 tsec 5.8590
#GCMRL#   15 dt 129.472000 rms  0.748  0.147% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5750 tsec 5.8910
#GCMRL#   16 dt 129.472000 rms  0.747  0.168% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4550 tsec 5.7700
#GCMRL#   17 dt 129.472000 rms  0.745  0.168% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4210 tsec 5.7320
#GCMRL#   18 dt 129.472000 rms  0.744  0.170% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5850 tsec 5.9000
#GCMRL#   19 dt 129.472000 rms  0.743  0.177% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.6060 tsec 5.9170
#GCMRL#   20 dt 129.472000 rms  0.741  0.190% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5020 tsec 5.8200
#GCMRL#   21 dt 129.472000 rms  0.740  0.204% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.3530 tsec 5.6660
#GCMRL#   22 dt 129.472000 rms  0.738  0.209% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.3990 tsec 5.7150
#GCMRL#   23 dt 129.472000 rms  0.737  0.195% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5560 tsec 5.8710
#GCMRL#   24 dt 129.472000 rms  0.736  0.176% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5080 tsec 5.8180
#GCMRL#   25 dt 129.472000 rms  0.735  0.146% neg 0  invalid 762 tFOTS 0.0000 tGradient 4.5790 tsec 4.9040
#GCMRL#   26 dt 129.472000 rms  0.734  0.136% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4860 tsec 5.8000
#GCMRL#   27 dt 129.472000 rms  0.733  0.132% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4730 tsec 5.7970
#GCMRL#   28 dt 129.472000 rms  0.732  0.120% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.5620 tsec 5.8740
#GCMRL#   29 dt 129.472000 rms  0.731  0.106% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4720 tsec 5.8030
#FOTS# QuadFit found better minimum quadopt=(dt=517.888,rms=0.730796) vs oldopt=(dt=369.92,rms=0.730814)
#GCMRL#   30 dt 517.888000 rms  0.731  0.000% neg 0  invalid 762 tFOTS 4.4080 tGradient 5.4660 tsec 10.2010
#GCMRL#   31 dt 517.888000 rms  0.731  0.023% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.2810 tsec 5.5960

#GCAMreg# pass 0 level1 5 level2 1 tsec 247.458 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.16 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=256, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.731361
#FOTS# QuadFit found better minimum quadopt=(dt=110.976,rms=0.730297) vs oldopt=(dt=92.48,rms=0.730309)
#GCMRL#   33 dt 110.976000 rms  0.730  0.145% neg 0  invalid 762 tFOTS 4.0660 tGradient 5.4080 tsec 9.7860
#FOTS# QuadFit found better minimum quadopt=(dt=129.472,rms=0.730204) vs oldopt=(dt=92.48,rms=0.730209)
#GCMRL#   34 dt 129.472000 rms  0.730  0.000% neg 0  invalid 762 tFOTS 4.3010 tGradient 5.3890 tsec 10.0100
#GCMRL#   35 dt 129.472000 rms  0.730  0.002% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.4650 tsec 5.7810
setting smoothness cost coefficient to 0.615

#GCAMreg# pass 0 level1 4 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.62 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=64, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.749325
#FOTS# QuadFit found better minimum quadopt=(dt=36.288,rms=0.747351) vs oldopt=(dt=25.92,rms=0.747474)
#GCMRL#   37 dt  36.288000 rms  0.747  0.263% neg 0  invalid 762 tFOTS 4.2430 tGradient 3.6630 tsec 8.2250
#FOTS# QuadFit found better minimum quadopt=(dt=36.288,rms=0.746735) vs oldopt=(dt=25.92,rms=0.746843)
#GCMRL#   38 dt  36.288000 rms  0.747  0.000% neg 0  invalid 762 tFOTS 3.7970 tGradient 3.7430 tsec 7.8620
#GCMRL#   39 dt  36.288000 rms  0.746  0.073% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5390 tsec 3.8480
#GCMRL#   40 dt  36.288000 rms  0.746  0.083% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6710 tsec 3.9830
#GCMRL#   41 dt  36.288000 rms  0.745  0.048% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.7110 tsec 4.0320
#GCMRL#   42 dt  36.288000 rms  0.745  0.092% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6610 tsec 3.9700
#GCMRL#   43 dt  36.288000 rms  0.742  0.273% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.7590 tsec 4.0710
#GCMRL#   44 dt  36.288000 rms  0.739  0.438% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.7310 tsec 4.0410
#GCMRL#   45 dt  36.288000 rms  0.735  0.554% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.7380 tsec 4.0540
#GCMRL#   46 dt  36.288000 rms  0.731  0.607% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6070 tsec 3.9210
#GCMRL#   47 dt  36.288000 rms  0.727  0.559% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6010 tsec 3.9130
#GCMRL#   48 dt  36.288000 rms  0.724  0.403% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6150 tsec 3.9220
#GCMRL#   49 dt  36.288000 rms  0.722  0.264% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6680 tsec 3.9760
#GCMRL#   50 dt  36.288000 rms  0.721  0.113% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5990 tsec 3.9030
#GCMRL#   51 dt  36.288000 rms  0.721  0.001% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5890 tsec 3.9100
#GCMRL#   52 dt  25.920000 rms  0.721  0.005% neg 0  invalid 762 tFOTS 4.3350 tGradient 3.6300 tsec 8.2760

#GCAMreg# pass 0 level1 4 level2 1 tsec 92.921 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.62 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=64, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.721698
#GCMRL#   54 dt   0.000000 rms  0.721  0.109% neg 0  invalid 762 tFOTS 4.1430 tGradient 3.5800 tsec 8.0300
setting smoothness cost coefficient to 2.353

#GCAMreg# pass 0 level1 3 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=2.35 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=16, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.767219
#FOTS# QuadFit found better minimum quadopt=(dt=1.6,rms=0.76627) vs oldopt=(dt=2,rms=0.766295)
#GCMRL#   56 dt   1.600000 rms  0.766  0.124% neg 0  invalid 762 tFOTS 3.8060 tGradient 2.4570 tsec 6.5800
#FOTS# QuadFit found better minimum quadopt=(dt=0.0375,rms=0.766243) vs oldopt=(dt=0.03125,rms=0.766243)
#GCMRL#   57 dt   0.037500 rms  0.766  0.000% neg 0  invalid 762 tFOTS 4.0450 tGradient 2.5610 tsec 6.9470

#GCAMreg# pass 0 level1 3 level2 1 tsec 25.507 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=2.35 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=16, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.767019
#FOTS# QuadFit found better minimum quadopt=(dt=0.0375,rms=0.766243) vs oldopt=(dt=0.03125,rms=0.766243)
#GCMRL#   59 dt   0.037500 rms  0.766  0.101% neg 0  invalid 762 tFOTS 3.9480 tGradient 2.4670 tsec 6.7370
#GCMRL#   60 dt   0.007812 rms  0.766  0.000% neg 0  invalid 762 tFOTS 3.8880 tGradient 2.6980 tsec 6.9120
#GCMRL#   61 dt   0.007812 rms  0.766  0.000% neg 0  invalid 762 tFOTS 0.0000 tGradient 2.6130 tsec 2.9230
setting smoothness cost coefficient to 8.000

#GCAMreg# pass 0 level1 2 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=8.00 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=4, sigma=2.0,type=2, relabel=0, neg=no

