Subject Stamp: freesurfer-linux-centos7_x86_64-7.1.0-20200511-813297b
Current Stamp: freesurfer-linux-centos7_x86_64-7.1.0-20200511-813297b
INFO: SUBJECTS_DIR is /user_data/csimmon2/long_pt/derivatives/freesurfer
Actual FREESURFER_HOME /opt/freesurfer/7.1.0
Linux mind-0-15 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Fri Oct 28 15:56:52 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux
Can't locate MNI/Startup.pm in @INC (you may need to install the MNI::Startup module) (@INC contains: /usr/local/lib64/perl5 /usr/local/share/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl /usr/lib64/perl5 /usr/share/perl5) at /opt/freesurfer/7.1.0/mni/bin/nu_correct line 37.
BEGIN failed--compilation aborted at /opt/freesurfer/7.1.0/mni/bin/nu_correct line 37.
'/opt/freesurfer/7.1.0/bin/recon-all' -> '/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/scripts/recon-all.local-copy'
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror

 mri_convert /user_data/csimmon2/long_pt/sub-007/ses-01/anat/sub-007_ses-01_T1w_brain_mirrored.nii.gz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig/001.mgz 

mri_convert /user_data/csimmon2/long_pt/sub-007/ses-01/anat/sub-007_ses-01_T1w_brain_mirrored.nii.gz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig/001.mgz 
reading from /user_data/csimmon2/long_pt/sub-007/ses-01/anat/sub-007_ses-01_T1w_brain_mirrored.nii.gz...
niiRead(): NIFTI_UNITS_UNKNOWN, assuming mm
niiRead(): detected input as 64 bit double, reading in as 32 bit float
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (1, 0, 0)
j_ras = (0, 1, 0)
k_ras = (0, 0, 1)
writing to /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig/001.mgz...
@#@FSTIME  2025:10:08:13:28:49 mri_convert N 2 e 0.72 S 0.01 U 0.77 P 108% M 51864 F 0 R 994 W 0 c 6 w 113 I 11584 O 8680 L 17.08 14.62 13.77
@#@FSLOADPOST 2025:10:08:13:28:50 mri_convert N 2 17.08 14.62 13.77
#--------------------------------------------
#@# MotionCor Wed Oct  8 13:28:50 EDT 2025
Found 1 runs
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig/001.mgz
Checking for (invalid) multi-frame inputs...
Only one run found so motion
correction will not be performed. I'll
copy the run to rawavg and continue.

 cp /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig/001.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/rawavg.mgz 

/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror

 mri_convert /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/rawavg.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig.mgz --conform 

mri_convert /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/rawavg.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig.mgz --conform 
reading from /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/rawavg.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (1, 0, 0)
j_ras = (0, 1, 0)
k_ras = (0, 0, 1)
changing data type from float to uchar (noscale = 0)...
MRIchangeType: Building histogram 0 438.855 1000, flo=0, fhi=0.999, dest_type=0
Reslicing using trilinear interpolation 
writing to /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig.mgz...
@#@FSTIME  2025:10:08:13:28:53 mri_convert N 3 e 1.41 S 0.01 U 1.46 P 105% M 63316 F 0 R 5985 W 0 c 13 w 65 I 0 O 3216 L 16.75 14.59 13.77
@#@FSLOADPOST 2025:10:08:13:28:55 mri_convert N 3 16.75 14.59 13.77

 mri_add_xform_to_header -c /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/transforms/talairach.xfm /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig.mgz /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/orig.mgz 

INFO: extension is mgz
@#@FSTIME  2025:10:08:13:28:55 mri_add_xform_to_header N 4 e 0.29 S 0.00 U 0.48 P 169% M 22764 F 0 R 973 W 0 c 20 w 56 I 0 O 3216 L 16.75 14.59 13.77
@#@FSLOADPOST 2025:10:08:13:28:55 mri_add_xform_to_header N 4 16.75 14.59 13.77
#--------------------------------------------
#@# Talairach Wed Oct  8 13:28:55 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 mri_nu_correct.mni --no-rescale --i orig.mgz --o orig_nu.mgz --ants-n4 --n 1 --proto-iters 1000 --distance 50 

/usr/bin/bc
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri
/opt/freesurfer/7.1.0/bin/mri_nu_correct.mni
--no-rescale --i orig.mgz --o orig_nu.mgz --ants-n4 --n 1 --proto-iters 1000 --distance 50
nIters 1
mri_nu_correct.mni 7.1.0
Linux mind-0-15 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Fri Oct 28 15:56:52 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux
Wed Oct  8 13:28:55 EDT 2025
Found /dev/shm , will use for temp dir
tmpdir is /dev/shm/tmp.mri_nu_correct.mni.2895467
cd /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri
AntsN4BiasFieldCorrectionFs -i orig.mgz -o /dev/shm/tmp.mri_nu_correct.mni.2895467/nu0.mgz
Using shrink factor: 4
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2895467/nu0.mgz orig_nu.mgz --like orig.mgz --conform
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2895467/nu0.mgz orig_nu.mgz --like orig.mgz --conform 
reading from /dev/shm/tmp.mri_nu_correct.mni.2895467/nu0.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 0, 0)
j_ras = (0, 0, -1)
k_ras = (0, 1, 0)
INFO: transform src into the like-volume: orig.mgz
writing to orig_nu.mgz...
 
 
Wed Oct  8 13:31:24 EDT 2025
mri_nu_correct.mni done
@#@FSTIME  2025:10:08:13:28:55 mri_nu_correct.mni N 12 e 148.30 S 0.08 U 148.10 P 99% M 486732 F 0 R 71873 W 0 c 116 w 231 I 3216 O 3392 L 16.75 14.59 13.77
@#@FSLOADPOST 2025:10:08:13:31:24 mri_nu_correct.mni N 12 15.33 15.02 14.07

 talairach_avi --i orig_nu.mgz --xfm transforms/talairach.auto.xfm --atlas 3T18yoSchwartzReactN32_as_orig 

talairach_avi log file is transforms/talairach_avi.log...
Started at Wed Oct 8 13:31:24 EDT 2025
Ended   at Wed Oct  8 13:31:38 EDT 2025
talairach_avi done
@#@FSTIME  2025:10:08:13:31:24 talairach_avi N 6 e 14.55 S 0.41 U 7.92 P 57% M 255404 F 4 R 28484 W 0 c 68 w 5520 I 42320 O 295968 L 15.33 15.02 14.07
@#@FSLOADPOST 2025:10:08:13:31:38 talairach_avi N 6 15.19 15.00 14.08

 cp transforms/talairach.auto.xfm transforms/talairach.xfm 

lta_convert --src orig.mgz --trg /opt/freesurfer/7.1.0/average/mni305.cor.mgz --inxfm transforms/talairach.xfm --outlta transforms/talairach.xfm.lta --subject fsaverage --ltavox2vox
7.1.0

--src: orig.mgz src image (geometry).
--trg: /opt/freesurfer/7.1.0/average/mni305.cor.mgz trg image (geometry).
--inmni: transforms/talairach.xfm input MNI/XFM transform.
--outlta: transforms/talairach.xfm.lta output LTA.
--s: fsaverage subject name
--ltavox2vox: output LTA as VOX_TO_VOX transform.
 LTA read, type : 1
 1.00743  -0.00927   0.00788   0.37489;
 0.00931   0.99146   0.14672  -6.30939;
-0.00162  -0.12267   1.13056  -30.55658;
 0.00000   0.00000   0.00000   1.00000;
setting subject to fsaverage
Writing  LTA to file transforms/talairach.xfm.lta...
lta_convert successful.
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/transforms /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri 
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri 
#--------------------------------------------
#@# Talairach Failure Detection Wed Oct  8 13:31:40 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 talairach_afd -T 0.005 -xfm transforms/talairach.xfm 

talairach_afd: Talairach Transform: transforms/talairach.xfm OK (p=0.7608, pval=0.6675 >= threshold=0.0050)
@#@FSTIME  2025:10:08:13:31:40 talairach_afd N 4 e 0.03 S 0.00 U 0.00 P 5% M 5320 F 10 R 197 W 0 c 0 w 18 I 2504 O 0 L 15.19 15.00 14.08
@#@FSLOADPOST 2025:10:08:13:31:40 talairach_afd N 4 15.19 15.00 14.08

 awk -f /opt/freesurfer/7.1.0/bin/extract_talairach_avi_QA.awk /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/transforms/talairach_avi.log 


 tal_QC_AZS /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/transforms/talairach_avi.log 

TalAviQA: 0.96178
z-score: -3
#--------------------------------------------
#@# Nu Intensity Correction Wed Oct  8 13:31:40 EDT 2025

 mri_nu_correct.mni --i orig.mgz --o nu.mgz --uchar transforms/talairach.xfm --proto-iters 1000 --distance 50 --n 1 --ants-n4 

/usr/bin/bc
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri
/opt/freesurfer/7.1.0/bin/mri_nu_correct.mni
--i orig.mgz --o nu.mgz --uchar transforms/talairach.xfm --proto-iters 1000 --distance 50 --n 1 --ants-n4
nIters 1
mri_nu_correct.mni 7.1.0
Linux mind-0-15 4.18.0-372.32.1.el8_6.x86_64 #1 SMP Fri Oct 28 15:56:52 EDT 2022 x86_64 x86_64 x86_64 GNU/Linux
Wed Oct  8 13:31:40 EDT 2025
Found /dev/shm , will use for temp dir
tmpdir is /dev/shm/tmp.mri_nu_correct.mni.2897425
cd /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri
AntsN4BiasFieldCorrectionFs -i orig.mgz -o /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz
Using shrink factor: 4
mri_binarize --i /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz --min -1 --o /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz

7.1.0
cwd /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri
cmdline mri_binarize --i /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz --min -1 --o /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz 
sysname  Linux
hostname mind-0-15
machine  x86_64
user     csimmon2

input      /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz
frame      0
nErode3d   0
nErode2d   0
output     /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz
Binarizing based on threshold
min        -1
max        +infinity
binval        1
binvalnot     0
fstart = 0, fend = 0, nframes = 1
Found 16777216 values in range
Counting number of voxels in first frame
Found 16777215 voxels in final mask
Count: 16777215 16777215.000000 16777216 99.999994
mri_binarize done
mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz --i orig.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897425/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897425/input.mean.dat

7.1.0
cwd 
cmdline mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz --i orig.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897425/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897425/input.mean.dat 
sysname  Linux
hostname mind-0-15
machine  x86_64
user     csimmon2
whitesurfname  white
UseRobust  0
Loading /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz
Loading orig.mgz
Voxel Volume is 1 mm^3
Generating list of segmentation ids
Found   1 segmentations
Computing statistics for each segmentation

Reporting on   1 segmentations
Using PrintSegStat
Computing spatial average of each frame
  0
Writing to /dev/shm/tmp.mri_nu_correct.mni.2897425/input.mean.dat
mri_segstats done
mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz --i /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897425/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897425/output.mean.dat

7.1.0
cwd 
cmdline mri_segstats --id 1 --seg /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz --i /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz --sum /dev/shm/tmp.mri_nu_correct.mni.2897425/sum.junk --avgwf /dev/shm/tmp.mri_nu_correct.mni.2897425/output.mean.dat 
sysname  Linux
hostname mind-0-15
machine  x86_64
user     csimmon2
whitesurfname  white
UseRobust  0
Loading /dev/shm/tmp.mri_nu_correct.mni.2897425/ones.mgz
Loading /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz
Voxel Volume is 1 mm^3
Generating list of segmentation ids
Found   1 segmentations
Computing statistics for each segmentation

Reporting on   1 segmentations
Using PrintSegStat
Computing spatial average of each frame
  0
Writing to /dev/shm/tmp.mri_nu_correct.mni.2897425/output.mean.dat
mri_segstats done
mris_calc -o /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz mul .98781797753485892264
Saving result to '/dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz' (type = MGH )                       [ ok ]
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz nu.mgz --like orig.mgz
mri_convert /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz nu.mgz --like orig.mgz 
reading from /dev/shm/tmp.mri_nu_correct.mni.2897425/nu0.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 0, 0)
j_ras = (0, 0, -1)
k_ras = (0, 1, 0)
INFO: transform src into the like-volume: orig.mgz
writing to nu.mgz...
mri_make_uchar nu.mgz transforms/talairach.xfm nu.mgz
type change took 0 minutes and 3 seconds.
mapping (43, 234) to ( 3, 110)
 
 
Wed Oct  8 13:34:19 EDT 2025
mri_nu_correct.mni done
@#@FSTIME  2025:10:08:13:31:40 mri_nu_correct.mni N 13 e 158.55 S 0.32 U 159.21 P 100% M 613708 F 1 R 222126 W 0 c 203 w 507 I 256 O 8584 L 15.19 15.00 14.08
@#@FSLOADPOST 2025:10:08:13:34:19 mri_nu_correct.mni N 13 17.39 16.18 14.69

 mri_add_xform_to_header -c /user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri/transforms/talairach.xfm nu.mgz nu.mgz 

INFO: extension is mgz
@#@FSTIME  2025:10:08:13:34:19 mri_add_xform_to_header N 4 e 0.32 S 0.01 U 0.47 P 147% M 22840 F 0 R 972 W 0 c 40 w 59 I 2856 O 2856 L 17.39 16.18 14.69
@#@FSLOADPOST 2025:10:08:13:34:19 mri_add_xform_to_header N 4 17.39 16.18 14.69
#--------------------------------------------
#@# Intensity Normalization Wed Oct  8 13:34:19 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 mri_normalize -g 1 -seed 1234 -mprage nu.mgz T1.mgz 

using max gradient = 1.000
setting seed for random number genererator to 1234
assuming input volume is MGH (Van der Kouwe) MP-RAGE
reading mri_src from nu.mgz...
normalizing image...
talairach transform
 1.00743  -0.00927   0.00788   0.37489;
 0.00931   0.99146   0.14672  -6.30939;
-0.00162  -0.12267   1.13056  -30.55658;
 0.00000   0.00000   0.00000   1.00000;
processing without aseg, no1d=0
MRInormInit(): 
INFO: Modifying talairach volume c_(r,a,s) based on average_305
MRInormalize(): 
MRIsplineNormalize(): npeaks = 22
Starting OpenSpline(): npoints = 22
building Voronoi diagram...
performing soap bubble smoothing, sigma = 8...

Iterating 2 times
---------------------------------
3d normalization pass 1 of 2
white matter peak found at 110
white matter peak found at 109
gm peak at 59 (59), valley at  0 (-1)
csf peak at 29, setting threshold to 49
building Voronoi diagram...
performing soap bubble smoothing, sigma = 8...
---------------------------------
3d normalization pass 2 of 2
white matter peak found at 110
white matter peak found at 110
gm peak at 59 (59), valley at  0 (-1)
csf peak at 29, setting threshold to 49
building Voronoi diagram...
performing soap bubble smoothing, sigma = 8...
Done iterating ---------------------------------
writing output to T1.mgz
3D bias adjustment took 1 minutes and 3 seconds.
@#@FSTIME  2025:10:08:13:34:19 mri_normalize N 7 e 63.07 S 0.10 U 78.71 P 124% M 583448 F 0 R 23066 W 0 c 80 w 71 I 2856 O 2600 L 17.39 16.18 14.69
@#@FSLOADPOST 2025:10:08:13:35:22 mri_normalize N 7 17.65 16.55 14.93
#--------------------------------------------
#@# Skull Stripping Wed Oct  8 13:35:22 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 mri_em_register -skull nu.mgz /opt/freesurfer/7.1.0/average/RB_all_withskull_2020_01_02.gca transforms/talairach_with_skull.lta 

aligning to atlas containing skull, setting unknown_nbr_spacing = 5

== Number of threads available to mri_em_register for OpenMP = 4 == 
reading 1 input volumes...
logging results to talairach_with_skull.log
reading '/opt/freesurfer/7.1.0/average/RB_all_withskull_2020_01_02.gca'...
GCAread took 0 minutes and 0 seconds.
average std = 23.0   using min determinant for regularization = 52.8
0 singular and 9205 ill-conditioned covariance matrices regularized
reading 'nu.mgz'...
freeing gibbs priors...done.
accounting for voxel sizes in initial transform
bounding unknown intensity as < 8.9 or > 556.0 
total sample mean = 77.3 (1403 zeros)
************************************************
spacing=8, using 3292 sample points, tol=1.00e-05...
************************************************
register_mri: find_optimal_transform
find_optimal_transform: nsamples 3292, passno 0, spacing 8
resetting wm mean[0]: 100 --> 108
resetting gm mean[0]: 61 --> 61
input volume #1 is the most T1-like
using real data threshold=26.0
skull bounding box = (59, 36, 21) --> (198, 160, 178)
finding center of left hemi white matter
using (105, 77, 100) as brain centroid of Right_Cerebral_White_Matter...
MRImask(): AllowDiffGeom = 1
mean wm in atlas = 108, using box (88,62,81) --> (122, 92,119) to find MRI wm
before smoothing, mri peak at 107
robust fit to distribution - 106 +- 5.5
after smoothing, mri peak at 107, scaling input intensities by 1.009
scaling channel 0 by 1.00935
initial log_p = -4.722
************************************************
First Search limited to translation only.
************************************************
max log p =    -4.627280 @ (-10.526, 10.526, -10.526)
max log p =    -4.267686 @ (5.263, 5.263, 5.263)
max log p =    -4.203915 @ (2.632, 7.895, 2.632)
max log p =    -4.163616 @ (-1.316, -3.947, -3.947)
max log p =    -4.149721 @ (0.658, 0.658, 3.289)
max log p =    -4.146514 @ (-0.987, 0.329, -3.618)
max log p =    -4.146514 @ (0.000, 0.000, 0.000)
max log p =    -4.146514 @ (0.000, 0.000, 0.000)
Found translation: (-4.3, 20.7, -6.9): log p = -4.147
****************************************
Nine parameter search.  iteration 0 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.135, old_max_log_p =-4.147 (thresh=-4.1)
 1.07500   0.00000   0.00000  -13.97973;
 0.00000   1.03837   0.27823  -9.28611;
 0.00000  -0.27823   1.03837   22.33493;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 24 seconds.
****************************************
Nine parameter search.  iteration 1 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.074, old_max_log_p =-4.135 (thresh=-4.1)
 0.99438   0.00000   0.00000  -3.54857;
 0.00000   1.22023   0.18169  -18.91107;
 0.00000  -0.12898   1.15159  -0.44030;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 23 seconds.
****************************************
Nine parameter search.  iteration 2 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-4.074, old_max_log_p =-4.074 (thresh=-4.1)
 0.99438   0.00000   0.00000  -3.54857;
 0.00000   1.22023   0.18169  -18.91107;
 0.00000  -0.12898   1.15159  -0.44030;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.2500
iteration took 0 minutes and 23 seconds.
****************************************
Nine parameter search.  iteration 3 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-4.026, old_max_log_p =-4.074 (thresh=-4.1)
 1.03111  -0.03903  -0.01081  -0.72849;
 0.03376   1.19231   0.33028  -36.25245;
 0.00000  -0.29254   1.13899   14.15604;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 22 seconds.
****************************************
Nine parameter search.  iteration 4 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-4.026, old_max_log_p =-4.026 (thresh=-4.0)
 1.03111  -0.03903  -0.01081  -0.72849;
 0.03376   1.19231   0.33028  -36.25245;
 0.00000  -0.29254   1.13899   14.15604;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.0625
iteration took 0 minutes and 22 seconds.
****************************************
Nine parameter search.  iteration 5 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-4.015, old_max_log_p =-4.026 (thresh=-4.0)
 1.03028  -0.01706  -0.01469  -2.22001;
 0.01690   1.19135   0.33017  -33.98101;
 0.00842  -0.29216   1.13619   13.35961;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 22 seconds.
****************************************
Nine parameter search.  iteration 6 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-4.004, old_max_log_p =-4.015 (thresh=-4.0)
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 22 seconds.
****************************************
Nine parameter search.  iteration 7 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-4.004, old_max_log_p =-4.004 (thresh=-4.0)
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;
min search scale 0.025000 reached
***********************************************
Computing MAP estimate using 3292 samples...
***********************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-05
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;
nsamples 3292
Quasinewton: input matrix
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 3 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 010: -log(p) =   -0.0  tol 0.000010
Resulting transform:
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;

pass 1, spacing 8: log(p) = -4.004 (old=-4.722)
transform before final EM align:
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;

**************************************************
 EM alignment process ...
 Computing final MAP estimate using 364986 samples. 
**************************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-07
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;
nsamples 364986
Quasinewton: input matrix
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 6 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 012: -log(p) =    4.5  tol 0.000000
final transform:
 1.03270  -0.01710  -0.01473  -2.51843;
 0.01688   1.18995   0.32978  -33.77417;
 0.00839  -0.29113   1.13220   13.70320;
 0.00000   0.00000   0.00000   1.00000;

writing output transformation to transforms/talairach_with_skull.lta...
#VMPC# mri_em_register VmPeak  824488
FSRUNTIME@ mri_em_register  0.0590 hours 4 threads
registration took 3 minutes and 32 seconds.
@#@FSTIME  2025:10:08:13:35:22 mri_em_register N 4 e 212.39 S 1.65 U 765.00 P 360% M 628368 F 0 R 956532 W 0 c 688 w 223 I 0 O 24 L 17.65 16.55 14.93
@#@FSLOADPOST 2025:10:08:13:38:55 mri_em_register N 4 19.10 18.79 16.22

 mri_watershed -T1 -brain_atlas /opt/freesurfer/7.1.0/average/RB_all_withskull_2020_01_02.gca transforms/talairach_with_skull.lta T1.mgz brainmask.auto.mgz 


Mode:          T1 normalized volume
Mode:          Use the information of atlas (default parms, --help for details)

*********************************************************
The input file is T1.mgz
The output file is brainmask.auto.mgz
Weighting the input with atlas information before watershed

*************************WATERSHED**************************
Sorting...
      first estimation of the COG coord: x=127 y=92 z=108 r=59
      first estimation of the main basin volume: 869008 voxels
      Looking for seedpoints 
        2 found in the cerebellum 
        15 found in the rest of the brain 
      global maximum in x=106, y=81, z=81, Imax=255
      CSF=12, WM_intensity=110, WM_VARIANCE=5
      WM_MIN=110, WM_HALF_MIN=110, WM_HALF_MAX=110, WM_MAX=110 
      preflooding height equal to 10 percent
done.
Analyze...

      main basin size=8091327797 voxels, voxel volume =1.000 
                     = 8091327797 mmm3 = 8091328.000 cm3
done.
PostAnalyze...Basin Prior
 56 basins merged thanks to atlas 
      ***** 0 basin(s) merged in 1 iteration(s)
      ***** 0 voxel(s) added to the main basin
done.
Weighting the input with prior template 

****************TEMPLATE DEFORMATION****************

      second estimation of the COG coord: x=128,y=98, z=104, r=8752 iterations
^^^^^^^^ couldn't find WM with original limits - expanding ^^^^^^

   GLOBAL      CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 45864
  RIGHT_CER    CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 3168
  LEFT_CER     CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 2790
 RIGHT_BRAIN   CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 19152
 LEFT_BRAIN    CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 19998
    OTHER      CSF_MIN=1, CSF_intensity=2, CSF_MAX=3 , nb = 756
   
                     CSF_MAX  TRANSITION  GM_MIN  GM
    GLOBAL     
  before analyzing :    3,      4,        32,   50
  after  analyzing :    3,      22,        32,   29
   RIGHT_CER   
  before analyzing :    3,      3,        33,   63
  after  analyzing :    3,      23,        33,   33
   LEFT_CER    
  before analyzing :    3,      4,        34,   64
  after  analyzing :    3,      24,        34,   34
  RIGHT_BRAIN  
  before analyzing :    3,      4,        32,   50
  after  analyzing :    3,      22,        32,   29
  LEFT_BRAIN   
  before analyzing :    3,      4,        32,   50
  after  analyzing :    3,      22,        32,   29
     OTHER     
  before analyzing :    3,      5,        69,   95
  after  analyzing :    3,      47,        69,   59
      mri_strip_skull: done peeling brain
      highly tesselated surface with 10242 vertices
      matching...75 iterations

*********************VALIDATION*********************
curvature mean = -0.012, std = 0.012
curvature mean = 72.220, std = 8.058

No Rigid alignment: -atlas Mode Off (basic atlas / no registration)
      before rotation: sse = 3.61, sigma = 7.20
      after  rotation: sse = 3.61, sigma = 7.20
Localization of inacurate regions: Erosion-Dilation steps
      the sse mean is  4.37, its var is 12.06   
      before Erosion-Dilatation  1.55% of inacurate vertices
      after  Erosion-Dilatation  0.00% of inacurate vertices
      Validation of the shape of the surface done.
Scaling of atlas fields onto current surface fields

********FINAL ITERATIVE TEMPLATE DEFORMATION********
Compute Local values csf/gray
Fine Segmentation...35 iterations

      mri_strip_skull: done peeling brain

Brain Size = 1795072 voxels, voxel volume = 1.000 mm3
           = 1795072 mmm3 = 1795.072 cm3
MRImask(): AllowDiffGeom = 1


******************************
Saving brainmask.auto.mgz
done
mri_watershed utimesec    13.323309
mri_watershed stimesec    0.178253
mri_watershed ru_maxrss   804088
mri_watershed ru_ixrss    0
mri_watershed ru_idrss    0
mri_watershed ru_isrss    0
mri_watershed ru_minflt   289446
mri_watershed ru_majflt   7
mri_watershed ru_nswap    0
mri_watershed ru_inblock  9952
mri_watershed ru_oublock  2600
mri_watershed ru_msgsnd   0
mri_watershed ru_msgrcv   0
mri_watershed ru_nsignals 0
mri_watershed ru_nvcsw    806
mri_watershed ru_nivcsw   40
mri_watershed done
@#@FSTIME  2025:10:08:13:38:55 mri_watershed N 6 e 9.32 S 0.20 U 13.32 P 144% M 804088 F 7 R 289462 W 0 c 41 w 807 I 9952 O 2600 L 19.10 18.79 16.22
@#@FSLOADPOST 2025:10:08:13:39:04 mri_watershed N 6 18.76 18.73 16.23

 cp brainmask.auto.mgz brainmask.mgz 

#-------------------------------------
#@# EM Registration Wed Oct  8 13:39:05 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 mri_em_register -uns 3 -mask brainmask.mgz nu.mgz /opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca transforms/talairach.lta 

setting unknown_nbr_spacing = 3
using MR volume brainmask.mgz to mask input volume...

== Number of threads available to mri_em_register for OpenMP = 4 == 
reading 1 input volumes...
logging results to talairach.log
reading '/opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca'...
GCAread took 0 minutes and 1 seconds.
average std = 7.2   using min determinant for regularization = 5.2
0 singular and 884 ill-conditioned covariance matrices regularized
reading 'nu.mgz'...
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
freeing gibbs priors...done.
accounting for voxel sizes in initial transform
bounding unknown intensity as < 5.9 or > 519.0 
total sample mean = 79.1 (1017 zeros)
************************************************
spacing=8, using 2841 sample points, tol=1.00e-05...
************************************************
register_mri: find_optimal_transform
find_optimal_transform: nsamples 2841, passno 0, spacing 8
resetting wm mean[0]: 98 --> 107
resetting gm mean[0]: 61 --> 61
input volume #1 is the most T1-like
using real data threshold=25.0
skull bounding box = (59, 36, 21) --> (198, 160, 178)
finding center of left hemi white matter
using (105, 77, 100) as brain centroid of Right_Cerebral_White_Matter...
MRImask(): AllowDiffGeom = 1
mean wm in atlas = 107, using box (88,62,81) --> (122, 92,119) to find MRI wm
before smoothing, mri peak at 107
robust fit to distribution - 106 +- 5.5
after smoothing, mri peak at 107, scaling input intensities by 1.000
scaling channel 0 by 1
initial log_p = -4.476
************************************************
First Search limited to translation only.
************************************************
max log p =    -4.138098 @ (-10.526, 31.579, -10.526)
max log p =    -3.573928 @ (5.263, -5.263, 5.263)
max log p =    -3.482857 @ (2.632, -2.632, 2.632)
max log p =    -3.479532 @ (-1.316, -1.316, -1.316)
max log p =    -3.464817 @ (0.658, 0.658, 0.658)
max log p =    -3.460350 @ (-0.987, -0.329, 0.329)
max log p =    -3.460350 @ (0.000, 0.000, 0.000)
max log p =    -3.460350 @ (0.000, 0.000, 0.000)
Found translation: (-4.3, 22.7, -3.0): log p = -3.460
****************************************
Nine parameter search.  iteration 0 nscales = 0 ...
****************************************
Result so far: scale 1.000: max_log_p=-3.458, old_max_log_p =-3.460 (thresh=-3.5)
 1.00000   0.00000   0.00000  -4.27632;
 0.00000   1.07500   0.00000   15.45289;
 0.00000   0.00000   1.00000  -2.96053;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.2500
iteration took 0 minutes and 20 seconds.
****************************************
Nine parameter search.  iteration 1 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-3.302, old_max_log_p =-3.458 (thresh=-3.5)
 0.98055   0.00000   0.00000   0.14857;
 0.00000   1.10612   0.13053  -3.56626;
 0.00000  -0.14032   0.95394   17.70475;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 20 seconds.
****************************************
Nine parameter search.  iteration 2 nscales = 1 ...
****************************************
Result so far: scale 0.250: max_log_p=-3.302, old_max_log_p =-3.302 (thresh=-3.3)
 0.98055   0.00000   0.00000   0.14857;
 0.00000   1.10612   0.13053  -3.56626;
 0.00000  -0.14032   0.95394   17.70475;
 0.00000   0.00000   0.00000   1.00000;
reducing scale to 0.0625
iteration took 0 minutes and 20 seconds.
****************************************
Nine parameter search.  iteration 3 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.258, old_max_log_p =-3.302 (thresh=-3.3)
 0.98025  -0.02726  -0.00231   2.17998;
 0.02406   1.10793   0.11487  -4.72507;
-0.00053  -0.12233   0.95707   14.26083;
 0.00000   0.00000   0.00000   1.00000;
iteration took 0 minutes and 19 seconds.
****************************************
Nine parameter search.  iteration 4 nscales = 2 ...
****************************************
Result so far: scale 0.062: max_log_p=-3.258, old_max_log_p =-3.258 (thresh=-3.3)
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;
min search scale 0.025000 reached
***********************************************
Computing MAP estimate using 2841 samples...
***********************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-05
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;
nsamples 2841
Quasinewton: input matrix
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 3 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 007: -log(p) =   -0.0  tol 0.000010
Resulting transform:
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;

pass 1, spacing 8: log(p) = -3.258 (old=-4.476)
transform before final EM align:
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;

**************************************************
 EM alignment process ...
 Computing final MAP estimate using 315638 samples. 
**************************************************
dt = 5.00e-06, momentum=0.80, tol=1.00e-07
l_intensity = 1.0000
Aligning input volume to GCA...
Transform matrix
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;
nsamples 315638
Quasinewton: input matrix
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;
dfp_em_step_func: 008: -log(p) = 3.8
after pass:transform: ( 0.98, -0.03, -0.00, 2.18)
                      ( 0.02, 1.11, 0.11, -4.58)
                      ( -0.00, -0.12, 0.96, 14.37)
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 3 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESpass 2 through quasi-newton minimization...
 IFLAG= -1  LINE SEARCH FAILED. SEE DOCUMENTATION OF ROUTINE MCSRCH ERROR RETURN OF LINE SEARCH: INFO= 3 POSSIBLE CAUSES: FUNCTION OR GRADIENT ARE INCORRECT OR INCORRECT TOLERANCESoutof QuasiNewtonEMA: 010: -log(p) =    3.8  tol 0.000000
final transform:
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;

writing output transformation to transforms/talairach.lta...
#VMPC# mri_em_register VmPeak  811940
FSRUNTIME@ mri_em_register  0.0401 hours 4 threads
registration took 2 minutes and 24 seconds.
@#@FSTIME  2025:10:08:13:39:05 mri_em_register N 7 e 144.26 S 1.19 U 456.21 P 317% M 616036 F 0 R 1020605 W 0 c 457 w 285 I 139952 O 24 L 18.76 18.73 16.23
@#@FSLOADPOST 2025:10:08:13:41:29 mri_em_register N 7 15.98 17.60 16.17
#--------------------------------------
#@# CA Normalize Wed Oct  8 13:41:29 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 mri_ca_normalize -c ctrl_pts.mgz -mask brainmask.mgz nu.mgz /opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca transforms/talairach.lta norm.mgz 

writing control point volume to ctrl_pts.mgz
using MR volume brainmask.mgz to mask input volume...
reading 1 input volume
reading atlas from '/opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca'...
reading transform from 'transforms/talairach.lta'...
reading input volume from nu.mgz...
MRImask(): AllowDiffGeom = 1
resetting wm mean[0]: 98 --> 107
resetting gm mean[0]: 61 --> 61
input volume #1 is the most T1-like
using real data threshold=25.0
skull bounding box = (59, 36, 21) --> (198, 160, 178)
finding center of left hemi white matter
using (105, 77, 100) as brain centroid of Right_Cerebral_White_Matter...
MRImask(): AllowDiffGeom = 1
mean wm in atlas = 107, using box (88,62,81) --> (122, 92,119) to find MRI wm
before smoothing, mri peak at 107
robust fit to distribution - 106 +- 5.5
after smoothing, mri peak at 107, scaling input intensities by 1.000
scaling channel 0 by 1
using 246437 sample points...
INFO: compute sample coordinates transform
 0.98025  -0.02726  -0.00231   2.17998;
 0.02403   1.10663   0.11474  -4.57974;
-0.00052  -0.12219   0.95595   14.36766;
 0.00000   0.00000   0.00000   1.00000;
INFO: transform used
finding control points in Left_Cerebral_White_Matter....
found 40230 control points for structure...
bounding box (129, 37, 27) --> (197, 141, 200)
Left_Cerebral_White_Matter: limiting intensities to 93.0 --> 120.0
0 of 127 (0.0%) samples deleted
finding control points in Right_Cerebral_White_Matter....
found 39478 control points for structure...
bounding box (63, 39, 26) --> (131, 144, 201)
Right_Cerebral_White_Matter: limiting intensities to 94.0 --> 120.0
0 of 86 (0.0%) samples deleted
finding control points in Left_Cerebellum_White_Matter....
found 3105 control points for structure...
bounding box (132, 114, 53) --> (182, 155, 110)
Left_Cerebellum_White_Matter: limiting intensities to 109.0 --> 120.0
9 of 10 (90.0%) samples deleted
finding control points in Right_Cerebellum_White_Matter....
found 2710 control points for structure...
bounding box (86, 114, 51) --> (130, 156, 111)
Right_Cerebellum_White_Matter: limiting intensities to 111.0 --> 120.0
11 of 12 (91.7%) samples deleted
finding control points in Brain_Stem....
found 3475 control points for structure...
bounding box (113, 108, 91) --> (149, 170, 122)
Brain_Stem: limiting intensities to 113.0 --> 120.0
5 of 7 (71.4%) samples deleted
using 242 total control points for intensity normalization...
bias field = 0.976 +- 0.066
2 of 217 control points discarded
finding control points in Left_Cerebral_White_Matter....
found 40230 control points for structure...
bounding box (129, 37, 27) --> (197, 141, 200)
Left_Cerebral_White_Matter: limiting intensities to 89.0 --> 120.0
0 of 195 (0.0%) samples deleted
finding control points in Right_Cerebral_White_Matter....
found 39478 control points for structure...
bounding box (63, 39, 26) --> (131, 144, 201)
Right_Cerebral_White_Matter: limiting intensities to 92.0 --> 120.0
0 of 133 (0.0%) samples deleted
finding control points in Left_Cerebellum_White_Matter....
found 3105 control points for structure...
bounding box (132, 114, 53) --> (182, 155, 110)
Left_Cerebellum_White_Matter: limiting intensities to 88.0 --> 120.0
26 of 64 (40.6%) samples deleted
finding control points in Right_Cerebellum_White_Matter....
found 2710 control points for structure...
bounding box (86, 114, 51) --> (130, 156, 111)
Right_Cerebellum_White_Matter: limiting intensities to 88.0 --> 120.0
30 of 53 (56.6%) samples deleted
finding control points in Brain_Stem....
found 3475 control points for structure...
bounding box (113, 108, 91) --> (149, 170, 122)
Brain_Stem: limiting intensities to 94.0 --> 120.0
70 of 102 (68.6%) samples deleted
using 547 total control points for intensity normalization...
bias field = 0.993 +- 0.077
1 of 414 control points discarded
finding control points in Left_Cerebral_White_Matter....
found 40230 control points for structure...
bounding box (129, 37, 27) --> (197, 141, 200)
Left_Cerebral_White_Matter: limiting intensities to 88.0 --> 123.0
1 of 301 (0.3%) samples deleted
finding control points in Right_Cerebral_White_Matter....
found 39478 control points for structure...
bounding box (63, 39, 26) --> (131, 144, 201)
Right_Cerebral_White_Matter: limiting intensities to 88.0 --> 123.0
1 of 275 (0.4%) samples deleted
finding control points in Left_Cerebellum_White_Matter....
found 3105 control points for structure...
bounding box (132, 114, 53) --> (182, 155, 110)
Left_Cerebellum_White_Matter: limiting intensities to 88.0 --> 123.0
83 of 124 (66.9%) samples deleted
finding control points in Right_Cerebellum_White_Matter....
found 2710 control points for structure...
bounding box (86, 114, 51) --> (130, 156, 111)
Right_Cerebellum_White_Matter: limiting intensities to 88.0 --> 123.0
57 of 75 (76.0%) samples deleted
finding control points in Brain_Stem....
found 3475 control points for structure...
bounding box (113, 108, 91) --> (149, 170, 122)
Brain_Stem: limiting intensities to 91.0 --> 123.0
85 of 126 (67.5%) samples deleted
using 901 total control points for intensity normalization...
bias field = 1.001 +- 0.069
3 of 669 control points discarded
writing normalized volume to norm.mgz...
writing control points to ctrl_pts.mgz
freeing GCA...done.
normalization took 1 minutes and 2 seconds.
@#@FSTIME  2025:10:08:13:41:30 mri_ca_normalize N 8 e 62.40 S 0.26 U 64.23 P 103% M 916308 F 6 R 350918 W 0 c 88 w 358 I 1224 O 3664 L 15.98 17.60 16.17
@#@FSLOADPOST 2025:10:08:13:42:32 mri_ca_normalize N 8 16.65 17.50 16.24
#--------------------------------------
#@# CA Reg Wed Oct  8 13:42:32 EDT 2025
/user_data/csimmon2/long_pt/derivatives/freesurfer/sub-007_ses01_mirror/mri

 mri_ca_register -nobigventricles -T transforms/talairach.lta -align-after -mask brainmask.mgz norm.mgz /opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca transforms/talairach.m3z 

not handling expanded ventricles...
using previously computed transform transforms/talairach.lta
renormalizing sequences with structure alignment, equivalent to:
	-renormalize
	-regularize_mean 0.500
	-regularize 0.500
using MR volume brainmask.mgz to mask input volume...

== Number of threads available to mri_ca_register for OpenMP = 4 == 
reading 1 input volumes...
logging results to talairach.log
reading input volume 'norm.mgz'...
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
MRImask(): AllowDiffGeom = 1
reading GCA '/opt/freesurfer/7.1.0/average/RB_all_2020-01-02.gca'...
label assignment complete, 0 changed (0.00%)
freeing gibbs priors...done.
average std[0] = 5.0
Starting GCAMregister()
label assignment complete, 0 changed (0.00%)
npasses = 1, nlevels = 6
#pass# 1 of 1 ************************
enabling zero nodes
setting smoothness cost coefficient to 0.156

#GCAMreg# pass 0 level1 5 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.16 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=256, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.912747
#FOTS# QuadFit found better minimum quadopt=(dt=221.952,rms=0.820261) vs oldopt=(dt=369.92,rms=0.84872)
#GCMRL#    0 dt 221.952000 rms  0.820 10.133% neg 0  invalid 762 tFOTS 5.4010 tGradient 5.2020 tsec 11.0310
#FOTS# QuadFit found better minimum quadopt=(dt=221.952,rms=0.793129) vs oldopt=(dt=369.92,rms=0.7993)
#GCMRL#    1 dt 221.952000 rms  0.793  3.308% neg 0  invalid 762 tFOTS 5.7290 tGradient 5.2690 tsec 11.3940
#FOTS# QuadFit found better minimum quadopt=(dt=260.177,rms=0.77901) vs oldopt=(dt=369.92,rms=0.780784)
#GCMRL#    2 dt 260.176751 rms  0.779  1.780% neg 0  invalid 762 tFOTS 5.8130 tGradient 5.2070 tsec 11.4450
#FOTS# QuadFit found better minimum quadopt=(dt=228.211,rms=0.771933) vs oldopt=(dt=92.48,rms=0.773874)
#GCMRL#    3 dt 228.210526 rms  0.772  0.908% neg 0  invalid 762 tFOTS 5.8170 tGradient 5.3240 tsec 11.5510
#FOTS# QuadFit found better minimum quadopt=(dt=141.241,rms=0.766848) vs oldopt=(dt=92.48,rms=0.767709)
#GCMRL#    4 dt 141.241379 rms  0.767  0.659% neg 0  invalid 762 tFOTS 5.8170 tGradient 5.1130 tsec 11.3560
#FOTS# QuadFit found better minimum quadopt=(dt=1183.74,rms=0.755219) vs oldopt=(dt=1479.68,rms=0.756355)
#GCMRL#    5 dt 1183.744000 rms  0.755  1.516% neg 0  invalid 762 tFOTS 5.6640 tGradient 5.2380 tsec 11.3350
#FOTS# QuadFit found better minimum quadopt=(dt=110.976,rms=0.750067) vs oldopt=(dt=92.48,rms=0.750281)
#GCMRL#    6 dt 110.976000 rms  0.750  0.682% neg 0  invalid 762 tFOTS 5.7270 tGradient 5.1940 tsec 11.3490
#FOTS# QuadFit found better minimum quadopt=(dt=517.888,rms=0.748065) vs oldopt=(dt=369.92,rms=0.748436)
#GCMRL#    7 dt 517.888000 rms  0.748  0.267% neg 0  invalid 762 tFOTS 6.0460 tGradient 5.3480 tsec 11.8340
#GCMRL#    8 dt 369.920000 rms  0.747  0.000% neg 0  invalid 762 tFOTS 5.8930 tGradient 5.4370 tsec 11.7830

#GCAMreg# pass 0 level1 5 level2 1 tsec 118.279 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.16 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=256, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.747265
#FOTS# QuadFit found better minimum quadopt=(dt=129.472,rms=0.745625) vs oldopt=(dt=92.48,rms=0.745775)
#GCMRL#   10 dt 129.472000 rms  0.746  0.220% neg 0  invalid 762 tFOTS 5.7580 tGradient 5.2410 tsec 11.4330
#FOTS# QuadFit found better minimum quadopt=(dt=517.888,rms=0.744715) vs oldopt=(dt=369.92,rms=0.744786)
#GCMRL#   11 dt 517.888000 rms  0.745  0.000% neg 0  invalid 762 tFOTS 6.2360 tGradient 5.3590 tsec 12.0840
#GCMRL#   12 dt 517.888000 rms  0.743  0.175% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.1930 tsec 5.6080
#GCMRL#   13 dt 517.888000 rms  0.742  0.175% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.2370 tsec 5.6610
#GCMRL#   14 dt 517.888000 rms  0.740  0.240% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.1060 tsec 5.5340
#GCMRL#   15 dt 517.888000 rms  0.738  0.278% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.2770 tsec 5.6880
#GCMRL#   16 dt 517.888000 rms  0.736  0.341% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.3220 tsec 5.7210
#GCMRL#   17 dt 517.888000 rms  0.734  0.281% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.1770 tsec 5.5920
#GCMRL#   18 dt 517.888000 rms  0.733  0.122% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.1880 tsec 5.6080
#GCMRL#   19 dt 517.888000 rms  0.732  0.059% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.2100 tsec 5.6510
#FOTS# QuadFit found better minimum quadopt=(dt=129.472,rms=0.728627) vs oldopt=(dt=92.48,rms=0.729081)
#GCMRL#   20 dt 129.472000 rms  0.729  0.509% neg 0  invalid 762 tFOTS 5.6080 tGradient 5.1030 tsec 11.1440
#FOTS# QuadFit found better minimum quadopt=(dt=32.368,rms=0.72842) vs oldopt=(dt=23.12,rms=0.728421)
#GCMRL#   21 dt  32.368000 rms  0.728  0.000% neg 0  invalid 762 tFOTS 6.9150 tGradient 5.2020 tsec 12.5490
#GCMRL#   22 dt  32.368000 rms  0.728  0.001% neg 0  invalid 762 tFOTS 0.0000 tGradient 5.1360 tsec 5.5500
setting smoothness cost coefficient to 0.615

#GCAMreg# pass 0 level1 4 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.62 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=64, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.74008
#FOTS# QuadFit found better minimum quadopt=(dt=36.288,rms=0.738079) vs oldopt=(dt=25.92,rms=0.738279)
#GCMRL#   24 dt  36.288000 rms  0.738  0.270% neg 0  invalid 762 tFOTS 6.0680 tGradient 3.3400 tsec 9.8170
#FOTS# QuadFit found better minimum quadopt=(dt=36.288,rms=0.737471) vs oldopt=(dt=25.92,rms=0.737548)
#GCMRL#   25 dt  36.288000 rms  0.737  0.000% neg 0  invalid 762 tFOTS 5.7320 tGradient 3.5570 tsec 9.7290
#GCMRL#   26 dt  36.288000 rms  0.737  0.066% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5880 tsec 4.0030
#GCMRL#   27 dt  36.288000 rms  0.736  0.100% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5930 tsec 4.0230
#GCMRL#   28 dt  36.288000 rms  0.736  0.078% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5640 tsec 4.0440
#GCMRL#   29 dt  36.288000 rms  0.734  0.179% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.7670 tsec 4.1930
#GCMRL#   30 dt  36.288000 rms  0.732  0.329% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6570 tsec 4.0820
#GCMRL#   31 dt  36.288000 rms  0.728  0.488% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5330 tsec 3.9440
#GCMRL#   32 dt  36.288000 rms  0.724  0.619% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5760 tsec 4.0030
#GCMRL#   33 dt  36.288000 rms  0.719  0.649% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5550 tsec 3.9860
#GCMRL#   34 dt  36.288000 rms  0.715  0.546% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6750 tsec 4.1000
#GCMRL#   35 dt  36.288000 rms  0.712  0.396% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5800 tsec 4.0040
#GCMRL#   36 dt  36.288000 rms  0.711  0.221% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.6500 tsec 4.0910
#GCMRL#   37 dt  36.288000 rms  0.710  0.065% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5480 tsec 3.9680
#GCMRL#   38 dt  36.288000 rms  0.710 -0.033% neg 0  invalid 762 tFOTS 0.0000 tGradient 3.5750 tsec 4.3490

#GCAMreg# pass 0 level1 4 level2 1 tsec 91.501 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=0.62 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=64, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.710934
#GCMRL#   40 dt   0.000000 rms  0.710  0.081% neg 0  invalid 762 tFOTS 5.8450 tGradient 3.4990 tsec 9.8030
setting smoothness cost coefficient to 2.353

#GCAMreg# pass 0 level1 3 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=2.35 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=16, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.744976
#FOTS# QuadFit found better minimum quadopt=(dt=1.6,rms=0.744179) vs oldopt=(dt=2,rms=0.744187)
#GCMRL#   42 dt   1.600000 rms  0.744  0.107% neg 0  invalid 762 tFOTS 5.5120 tGradient 2.1200 tsec 8.0370
#FOTS# QuadFit found better minimum quadopt=(dt=0.175,rms=0.744185) vs oldopt=(dt=0.125,rms=0.744186)

#GCAMreg# pass 0 level1 3 level2 1 tsec 25.487 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=2.35 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=16, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.744741
#FOTS# QuadFit found better minimum quadopt=(dt=0.075,rms=0.744188) vs oldopt=(dt=0.125,rms=0.744188)
#GCMRL#   44 dt   0.075000 rms  0.744  0.074% neg 0  invalid 762 tFOTS 5.2630 tGradient 2.4540 tsec 8.1440
#GCMRL#   45 dt   0.007812 rms  0.744  0.000% neg 0  invalid 762 tFOTS 5.4570 tGradient 2.2200 tsec 8.1090
setting smoothness cost coefficient to 8.000

#GCAMreg# pass 0 level1 2 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=8.00 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=4, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.83772
#FOTS# QuadFit found better minimum quadopt=(dt=2.90823,rms=0.806571) vs oldopt=(dt=2.88,rms=0.806573)
#GCMRL#   47 dt   2.908233 rms  0.807  3.718% neg 0  invalid 762 tFOTS 5.4600 tGradient 1.7630 tsec 7.6420
#FOTS# QuadFit found better minimum quadopt=(dt=2.04141,rms=0.802492) vs oldopt=(dt=2.88,rms=0.803168)
#GCMRL#   48 dt   2.041408 rms  0.802  0.506% neg 0  invalid 762 tFOTS 5.5210 tGradient 1.7650 tsec 7.6990
#FOTS# QuadFit found better minimum quadopt=(dt=1.728,rms=0.801295) vs oldopt=(dt=2.88,rms=0.801712)
#GCMRL#   49 dt   1.728000 rms  0.801  0.000% neg 0  invalid 762 tFOTS 5.4360 tGradient 1.7770 tsec 7.6440

#GCAMreg# pass 0 level1 2 level2 1 tsec 34.544 sigma 0.5
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=8.00 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=4, sigma=0.5,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=0.500...
GCAMRegisterLevel(): init RMS 0.802006
#GCMRL#   51 dt   0.000000 rms  0.801  0.088% neg 0  invalid 762 tFOTS 4.2250 tGradient 1.7640 tsec 6.3330
setting smoothness cost coefficient to 20.000

#GCAMreg# pass 0 level1 1 level2 0 tsec 0 sigma 2
l_jacobian=1.00 l_label=1.00 l_log_likelihood=0.20 l_smoothness=20.00 
tol=2.50e-01, dt=5.00e-02, exp_k=20.0, momentum=0.90, levels=6, niter=500, lbl_dist=10.00, avgs=1, sigma=2.0,type=2, relabel=0, neg=no

blurring input image with Gaussian with sigma=2.000...
GCAMRegisterLevel(): init RMS 0.867066
#FOTS# QuadFit found better minimum quadopt=(dt=0.384,rms=0.865172) vs oldopt=(dt=0.32,rms=0.865193)
#GCMRL#   53 dt   0.384000 rms  0.865  0.218% neg 0  invalid 762 tFOTS 4.0670 tGradient 1.4900 tsec 5.9030
#FOTS# QuadFit found better minimum quadopt=(dt=1.06651,rms=0.857514) vs oldopt=(dt=1.28,rms=0.857676)
#GCMRL#   54 dt   1.066508 rms  0.858  0.885% neg 0  invalid 762 tFOTS 4.0440 tGradient 1.4660 tsec 5.8400
#FOTS# QuadFit found better minimum quadopt=(dt=0.192,rms=0.855762) vs oldopt=(dt=0.32,rms=0.856188)
#GCMRL#   55 dt   0.192000 rms  0.856  0.000% neg 0  invalid 762 tFOTS 4.0720 tGradient 1.4550 tsec 5.8810
#GCMRL#   56 dt   0.192000 rms  0.855  0.059% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.5380 tsec 1.8700
#GCMRL#   57 dt   0.192000 rms  0.855  0.045% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.5010 tsec 1.8290
#GCMRL#   58 dt   0.192000 rms  0.853  0.214% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.4680 tsec 1.8040
#GCMRL#   59 dt   0.192000 rms  0.850  0.365% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.4990 tsec 1.8370
#GCMRL#   60 dt   0.192000 rms  0.847  0.294% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.5490 tsec 1.8750
#GCMRL#   61 dt   0.192000 rms  0.846  0.147% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.4610 tsec 1.7900
#GCMRL#   62 dt   0.192000 rms  0.846  0.018% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.5530 tsec 1.8760
#GCMRL#   63 dt   0.192000 rms  0.846 -0.060% neg 0  invalid 762 tFOTS 0.0000 tGradient 1.5910 tsec 2.2100
